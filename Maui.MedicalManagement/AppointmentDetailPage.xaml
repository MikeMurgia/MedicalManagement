<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Maui.MedicalManagement.AppointmentDetailPage"
             Title="Schedule Appointment"
             BackgroundColor="#FAFAFA">

    <ScrollView Padding="20">
        <VerticalStackLayout Spacing="15">

            <Label Text="Appointment Details" 
                   FontSize="24" 
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="#212121"/>

            <!-- Validation Message -->
            <Border BackgroundColor="{Binding IsValid, x:DataType=Line, Converter={StaticResource BoolToColorConverter}}" 
                   Stroke="Transparent"
                   Padding="10"
                   IsVisible="{Binding ValidationMessage, Converter={StaticResource StringToBoolConverter}}">
                <Label Text="{Binding ValidationMessage}" 
                       TextColor="White"
                       HorizontalTextAlignment="Center"/>
            </Border>

            <Border BackgroundColor="#FFFFFF" 
                   Stroke="#BDBDBD"
                   Padding="15"
                   StrokeShape="RoundRectangle 10"
                   Shadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- Patient Selection -->
                    <Label Text="Select Patient:" FontAttributes="Bold" TextColor="#424242"/>
                    <Picker ItemsSource="{Binding AvailablePatients}"
                            SelectedItem="{Binding SelectedPatient}"
                            ItemDisplayBinding="{Binding Display}"
                            TextColor="#212121"
                            BackgroundColor="#FAFAFA">
                    </Picker>

                    <!-- Physician Selection -->
                    <Label Text="Select Physician:" FontAttributes="Bold" TextColor="#424242"/>
                    <Picker ItemsSource="{Binding AvailablePhysicians}"
                            SelectedItem="{Binding SelectedPhysician}"
                            ItemDisplayBinding="{Binding Display}"
                            TextColor="#212121"
                            BackgroundColor="#FAFAFA">
                    </Picker>

                    <!-- Date Selection -->
                    <Label Text="Appointment Date:" FontAttributes="Bold" TextColor="#424242"/>
                    <DatePicker Date="{Binding SelectedDate}" 
                                MinimumDate="{Binding MinDate}"
                                Format="D"
                                TextColor="#212121"
                                BackgroundColor="#FAFAFA"/>

                    <!-- Check Availability Button -->
                    <Button Text="Check Available Time Slots" 
                            Command="{Binding CheckAvailabilityCommand}"
                            BackgroundColor="#FF9800"
                            TextColor="White"/>

                    <!-- Time Selection -->
                    <Label Text="Select Time:" FontAttributes="Bold" TextColor="#424242"/>
                    <Picker ItemsSource="{Binding AvailableTimeSlots}"
                            SelectedItem="{Binding SelectedTime}"
                            TextColor="#212121"
                            BackgroundColor="#FAFAFA">
                        <Picker.ItemDisplayBinding>
                            <Binding StringFormat="{}{0:hh\:mm}"/>
                        </Picker.ItemDisplayBinding>
                    </Picker>

                    <Label Text="Note: Appointments are 30 minutes long" 
                           TextColor="#757575"
                           FontSize="12"
                           HorizontalTextAlignment="Center"/>

                </VerticalStackLayout>
            </Border>

            <!-- Business Hours Notice -->
            <Border BackgroundColor="#E3F2FD" 
                   Stroke="#2196F3"
                   Padding="10"
                   StrokeShape="RoundRectangle 5">
                <Label TextColor="#1976D2"
                       HorizontalTextAlignment="Center">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="ℹ️ " FontSize="16"/>
                            <Span Text="Business Hours: Monday-Friday, 8:00 AM - 5:00 PM" 
                                  FontAttributes="Bold"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
            </Border>

            <HorizontalStackLayout HorizontalOptions="Center" Spacing="20">
                <Button Text="Schedule" 
                        Command="{Binding SaveCommand}"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        WidthRequest="120"/>

                <Button Text="Cancel" 
                        Clicked="CancelClicked"
                        BackgroundColor="#757575"
                        TextColor="White"
                        WidthRequest="120"/>
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
